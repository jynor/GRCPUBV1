/*!
 *
 *  # Pipi: BiB/i Putter
 *
 *  - "Putting EPUBs in Web Page with BiB/i."
 *  - (c) Satoru MATSUSHIMA - http://bibi.epub.link/
 *  - Licensed under the MIT license. - http://www.opensource.org/licenses/mit-license.php
 *
 *  - Sat May 2 00:19:00 2015 +0900 */
Pipi={Version:"0.998.0",Build:20150502},function(a){window["bibi-pipi"]||(window["bibi-pipi"]={Status:"waiting"},"undefined"==typeof window.CustomEvent&&(window.CustomEvent=function(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c},window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1))}(function(){if("waiting"==window["bibi-pipi"].Status){window["bibi-pipi"].Status="processing";var a=document.querySelectorAll?document.querySelectorAll("a[data-bibi]"):function(a,b){for(var c=a.length,d=0;c>d;d++)a[d].getAttribute("data-bibi")&&b.push(a[d]);return b}(document.body.getElementsByTagName("a"),[]);if(a.length){var b=function(a,b){var c=document.createElement(a);for(var d in b)c[d]=b[d];return c},c=document.querySelector('script[src$="bib/i.js"]').src.replace(/\.js$/,""),d=function(a){return a.requestFullscreen||a.requestFullScreen?!0:a.webkitRequestFullscreen||a.webkitRequestFullScreen?!0:a.mozRequestFullscreen||a.mozRequestFullScreen?!0:a.msRequestFullscreen?!0:!1}(document.body);d&&(window["bibi-pipi"].requestFullscreen=function(a){return a.requestFullscreen?a.requestFullscreen():a.requestFullScreen?a.requestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.mozRequestFullscreen?a.mozRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():void 0},window["bibi-pipi"].exitFullscreen=function(a){return a.exitFullscreen?a.exitFullscreen():a.cencelFullScreen?a.cancelFullScreen():a.webkitExitFullscreen?a.webkitExitFullscreen():a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.mozExitFullscreen?a.mozExitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.msExitFullscreen?a.msExitFullscreen():void 0},window["bibi-pipi"].getFullscreenElement=function(a){return a.fullscreenElement?a.fullscreenElement:a.fullScreenElement?a.fullScreenElement:a.webkitFullscreenElement?a.webkitFullscreenElement:a.webkitFullScreenElement?a.webkitFullScreenElement:a.mozFullscreenElement?a.mozFullscreenElement:a.mozFullScreenElement?a.mozFullScreenElement:a.msFullscreenElement?a.msFullscreenElement:null}),document.getElementsByTagName("head")[0].appendChild(b("link",{rel:"stylesheet",id:"bibi-css",href:c+".css"})),window["bibi-pipi"].Holders=[];for(var e=a.length,f=0;e>f;f++)if(a[f].getAttribute("href")){var g=b("span",{className:"bibi-holder "+(d?"bibi-fullscreen-enabled":"bibi-fullscreen-not-enabled"),title:(a[f].innerText?a[f].innerText+" ":"")+"(powered by BiB/i)"}),h=a[f].getAttribute("href"),i=h,j=a[f].getAttribute("data-bibi-class"),k=a[f].getAttribute("data-bibi-id"),l=a[f].getAttribute("data-bibi-style"),m=a[f].getAttribute("data-bibi-poster"),n=a[f].getAttribute("data-bibi-autostart");if(j&&(g.className+=" "+j),k&&(g.id=k),l&&g.setAttribute("style",l),n&&!/^(false|no)$/.test(n))i+=(/#/.test(i)?",":"#")+"pipi(autostart:true)";else if(m){var o=b("link",{href:m});m=o.href,delete o,i+=(/#/.test(i)?",":"#")+"pipi(poster:"+encodeURIComponent(m).replace("(","_BibiKakkoOpen_").replace(")","_BibiKakkoClose_")+")"}a[f].style.display="none",a[f].parentNode.insertBefore(g,a[f]),g.appendChild(b("iframe",{className:"bibi-frame",frameborder:"0",scrolling:"auto",allowfullscreen:"true",webkitallowfullscreen:"true",mozallowfullscreen:"true",src:i})),g.SwitchNewWindow=g.appendChild(b("a",{className:"bibi-icon bibi-switch-newwindow",title:"Open in New Window",target:"_blank",href:h})),d&&(g.className+=" bibi-fullscreen-enabled",g.SwitchFullscreen=g.appendChild(b("span",{className:"bibi-icon bibi-switch-fullscreen",title:"Enter Fullscreen",Holder:g,onclick:function(){window["bibi-pipi"].getFullscreenElement(document)?(window["bibi-pipi"].exitFullscreen(document),this.title="Enter Fullscreen"):(window["bibi-pipi"].requestFullscreen(this.Holder),this.title="Exit Fullscreen")}}))),window["bibi-pipi"].Holders.push(g),a[f].dispatchEvent(new CustomEvent("bibi:holderadded",{bubbles:!0,cancelable:!0,detail:{holder:g}}))}}window["bibi-pipi"].Status="processed"}});